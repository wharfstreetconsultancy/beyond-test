<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Suroor Fashions - Product Management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/main.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel='shortcut icon' type='image/x-icon' href='img/favicon.jpg'/>
  </head>
  <body onLoad="{onload.action}">
    <!------------------------------ Header --------------------------->
    <!--This is the Header Content-->
  	<div class="container-fluid">
  		<div class="row">
  			<div class="col-sm-1 header">
  				<div class="col-xs-1 col-md-1 col-lg-1 text-center">
  					<a href="/"><img src="img/SVGlogo.svg" class="img" alt="Suroor Fashions - Product Management"></a>
  				</div>
  			</div>
  		</div>
    </div>
  	<nav class="navbar navbar-default">
  		  <div class="container-fluid nav-con">
  			<!--Brand and toggle get grouped for better mobile display-->
  			<div class="navbar-header">
  				<div class="col-sm-1 header">
  				  <button type="button" class="navbar-toggle x collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
  					<span class="sr-only">Toggle navigation</span>
  					<span class="icon-bar"></span>
  					<span class="icon-bar second-bar"></span>
  				  </button>
  			  	</div>
  			</div>
  			<!--Collect the nav links, forms, and other content for toggling-->
  			<div class="collapse navbar-collapse cool-nav" id="bs-example-navbar-collapse-1">Product Management</div>
  		  </div>
    </nav>

    <!---------------------------Body ------------------------->
    <div class="body">
        <!-- Title -->
        <div class="row">
            <form id="product_details" action="/" method="post" enctype="multipart/form-data">
                <input id="id" type="hidden" name="id">
                <input id="creationTimestamp" type="hidden" name="creationTimestamp">
                <div class="col-lg-12">
                    <table width="100%"><tr><td>
                        <h1>Product Editor</h1>
                    </td><td align="right">
                        <input id="post" name="action" type="submit" class="btn btn-primary" value="Create"><input id="put" name="action" type="submit" class="btn btn-primary" value="Update"><input id="delete" name="action" type="submit" class="btn btn-primary" value="Delete"><input id="reset" type="reset" class="btn btn-primary" value="Clear"><br>
                    </td></tr></table>
                </div>
                <div class="caption">
                    {user.prompt}<br>
                </div>
<table width="100%"><tr><td align="left" valign="top" width="25%">
                <div class="caption">
                    <b>Name:</b><br>
                    <input id="name" type="text" name="name"><br>
                </div>
                <div class="caption">
                    <b>Description:</b><br>
                    <input id="description" type="text" name="description"><br>
                </div>
                <div class="caption">
                    <b>Price:</b><br>
                    <input id="price" type="text" name="price"><br>
                </div>
</td><td align="left" valign="top" width="25%">
                <div class="caption">
                    <b>Type:</b><br>
                    <input id="type_clothing" type="radio" name="type" value="CLOTHING" checked> Clothing<br>
                    <input id="type_jewellery" type="radio" name="type" value="JEWELLERY"> Jewellery<br>
                </div>
                <div class="caption">
                    <b>Status:</b><br>
                    <input id="promoted" type="checkbox" name="promoted" value="true"> On Promotion<br>
                </div>
            </form>
</td><td align="left" valign="top">
            <img id="selected_image"/>
</td><td align="left" valign="top">
            <form id="product_image"  method="post" enctype="multipart/form-data">
                <input id="image_loc" type="hidden" name="image_loc">
                <input id="image_tag" type="hidden" name="image_tag">
                <div class="caption">
                    <table id="image_list">
                        <!-- tr><td><input id='Image 1' type='radio' name='selected_image' value='{"default": "true", "location": "https://gd678vg76sgg76gs/", "tag": "gd678vg76sgg76gs"}' onclick='selectImage(this)'> Image 1</input></td><td><div id="gd678vg76sgg76gs_default_cell">&nbsp;</div></td><td></td></tr>
                        <tr><td><input id='Image 2' type='radio' name='selected_image' value='{"default": "false", "location": "https://gd678vg76sgg76gt/", "tag": "gd678vg76sgg76gt"}' onclick='selectImage(this)'> Image 2</input></td><td><div id="gd678vg76sgg76gt_default_cell">&nbsp;</div></td><td></td></tr>
                        <tr><td><input id='Image 3' type='radio' name='selected_image' value='{"default": "false", "location": "https://gd678vg76sgg76gu/", "tag": "gd678vg76sgg76gu"}' onclick='selectImage(this)'> Image 3</input></td><td><div id="gd678vg76sgg76gu_default_cell">&nbsp;</div></td><td></td></tr>
                        <tr><td colspan='2'><b>New Image</b><input id="image_files" type="file"/></td><td></td><td><input id="create" name="action" type="submit" class="btn btn-primary" value="Upload"></td></tr -->
                    </table>
                </div>
            </form>
</td></tr></table>
        </div>
        <hr>
        <div class="row">
<form id="product_catalog">
<table width="100%"><tr><td align="left" valign="top" width="50%">
            <div class="col-lg-12">
                <h1>Current Clothing Catalog</h1>
                **denotes product to be displayed in showcase carousel<br>
                {products.list.clothing}
            </div>
</td><td align="left" valign="top" width="50%">
            <div class="col-lg-12">
                <h1>Current Jewellery Catalog</h1>
                **denotes product to be displayed in showcase carousel<br>
                {products.list.jewellery}
            </div>
</td></tr></table>
</form>
        </div>
    </div>

    <!------------------------------- Footer --------------------->
    <footer>
      <div class="container-fluid">
        <div class="footer">
          <p class="copyright">&copy 2017 Suroor Fasions | All Rights Reserved</p>
          <p class="links"><a href="#">Terms of use </a></p>
          <span class="links">|</span>
          <p class="links"><a href="#">Privacy Policy </a></p>
          <span class="links">|</span>
          <p class="links"><a href="#">Sales & Return Policy</a></p>
        </div>
      </div>
    </footer>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script>
function findProduct(id) {
        console.log("Product ID: "+id);
	var selectedProduct = document.getElementById(id);
	selectedProduct.checked = true;
	return selectedProduct;
}

function selectProduct(product) {
	console.log("Selected product: "+product.value);
	var selectedProduct = JSON.parse(product.value);
	document.getElementById('id').value = selectedProduct.id;
	document.getElementById('creationTimestamp').value = selectedProduct.creationTimestamp;
	document.getElementById('name').value = selectedProduct.name;
	document.getElementById('description').value = selectedProduct.description;
	document.getElementById('price').value = selectedProduct.price;
        document.getElementById('product_image').action = '/product/'+selectedProduct.id+'/image';
	var imageHtmlBuffer = '';
	if(selectedProduct.images) {
		for(var imageString of selectedProduct.images) {
			var image = JSON.parse(imageString);
			// document.getElementById('image'+counter+'_src').src = image.location;
        		// document.getElementById('image'+counter+'_loc').value = image.location;
			document.getElementById('image_list').innerHTML += '<tr><td><input id=\''+image.tag+'\' type=\'radio\' name=\'selected_image\' value=\'imageString\' onclick=\'selectImage(this)\'> Image 1</input></td><td><div id=\''+image.tag+'_default_cell\'>&nbsp;</div></td><td></td></tr>';
		}
	}
	document.getElementById('image_list').innerHTML += '<tr><td colspan=\'2\'><b>New Image</b><input id=\'image_files\' name=\'image_files\' type=\'file\'/></td><td></td><td><input id=\'create\' name=\'action\' type=\'submit\' class=\'btn btn-primary\' value=\'Upload\'></td></tr>';
	document.getElementById('type_'+selectedProduct.type.toLowerCase()).checked = true;
	document.getElementById('promoted').checked = selectedProduct.promoted;
}

function selectImage(image) {
        console.log("Selected image: "+image.value);
        var selectedImage = JSON.parse(image.value);
        document.getElementById('selected_image').src = selectedImage.location;
        document.getElementById('image_loc').value = selectedImage.location;
        document.getElementById('image_tag').value = selectedImage.tag;
        for(var product of document.getElementById('product_catalog')) {
		if(product.checked) {
			console.log("Chosen product: "+JSON.stringify(product.value));
		}
	}
        document.getElementById(selectedImage.tag+'_default_cell').innerHTML = '<input id="default_image" type="checkbox" checked="'+selectedImage.isDefault+'"> (default image)</input>';
}
    </script>
  </body>
</html>

<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>Suroor Fashions - Marketplace</title>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<link rel="stylesheet" href="css/bootstrap.css"/>
		<link rel="stylesheet" href="css/header.css"/>
		<link rel="stylesheet" href="css/footer.css"/>
		<link rel="stylesheet" href="css/main.css"/>
		<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"/>
		<link rel="stylesheet" href="css/font-awesome.min.css"/>
		<link rel='shortcut icon' type='image/x-icon' href='img/favicon.jpg'/>
		<style>
.panel-heading {
	height: 41px;
}
display: inline-flex
Margin: 15px;
@media (min-width:1200px) {
	margin: 60px;
}
		</style>
	</head>
	<body>
		<!------------------------------ Header --------------------------->
		<span id="body_header"></span>
		<!---------------------------Body ------------------------->
		<div class="body">
	      <div class="container-fluid">
				<div class="col-lg-6 col-lg-offset-3">
					<div class="panel panel-primary">
						<div class="panel-heading">
							<div class="row">
								<div id="cart_title" class="col-lg-12">Please Sign-in...</div>
							</div>
						</div>
						<div class="panel-body">
								<div class="row">
									<div class="col-lg-12">
							<form id="signin_form" class="form-inline">
										<p><span id="cust_msg">Please provide your customer credentials or <a href="/signup">sign-up</a> if you have not yet registered...</span></p>
										<input id="email" name="email" type="text" placeholder="Email..."/><br>
										<input id="password" name="password" type="password" placeholder="Password..."/><br>
							</form>
									</div>
								</div>
								<hr>
								<div class="row">
									<div class="col-lg-12">
										<button id="signin_btn" type="submit" value="signin" form="signin_form" class="btn btn-primary btn-block">Sign-in</button><br>
										<a href="/signup">Sign-up here</a>
									</div>
								</div>
						</div>
						<div class="panel-footer">
						</div>
					</div>
				</div>
			</div>
		</div>


		<!------------------------------- Footer --------------------->
		<span id="body_footer"></span>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script>$(document).ready(function() {$("#body_header").load("js/body_header.js");});</script>
		<script>$(document).ready(function() {$("#body_footer").load("js/body_footer.js");});</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<script src="https://www.paypalobjects.com/api/checkout.js"></script>
		<script src="https://js.braintreegateway.com/web/3.22.2/js/client.min.js"></script>
		<script src="https://js.braintreegateway.com/web/3.22.2/js/paypal-checkout.min.js"></script>
		<script>
$(document).ready(function() {
	$('#signin_form').on('click', '#signin_btn', function () {

		$('#signin_form').ajaxSubmit({
			
			url: '/customer/session',
			type: 'post',
			dataType: 'json',
			success: function (customer, status, xhr) {
		
				$('#status').empty().text('Sign-in success');
				sessionStorage.setItem('customer', JSON.stringify(customer));
				console.log("Sign-in success: "+JSON.stringify(customer));

				if({check.cart}) {
					
					document.getElementById("cart_checkout").click();
				} else {
					
					document.location.href='/';
				}
			},
			error: function (xhr) {

				console.log("Failed to sign-in: "+xhr.responseJSON.error.code);
				console.log("Error message returned: "+xhr.responseJSON.error.message);
				var errorMessage = 'Failed to sign-in. Please retry...';
				if(xhr.responseJSON.error.code == 'NotAuthorizedException') {

					errorMessage = xhr.responseJSON.error.message+' Please retry...';
				} else if(xhr.responseJSON.error.code == 'UserNotConfirmedException') {

					errorMessage = xhr.responseJSON.error.message+' Please check your mail...';
				}
				document.getElementById("cust_msg").innerHTML = errorMessage;
			}
		});
		return false;
	});
});
		</script>
	</body>
</html>
